<!-- Breadcrumbs-->
<ol class="breadcrumb">
    <li class="breadcrumb-item">
        <a routerLink="/">仪表盘</a>
    </li>
    <li class="breadcrumb-item active">总揽</li>
</ol>
<!-- Icon Cards-->
<div class="row">
    <div class="col-xl-3 col-sm-6 mb-3">
        <div class="card text-white bg-primary o-hidden h-100">
            <div class="card-body">
                <div class="card-body-icon">
                    <i class="fa fa-fw fa-newspaper-o"></i>
                </div>
                <div class="mr-5">{{stationsInfo?stationsInfo.length:0}}台运行的工作站</div>
            </div>
            <a class="card-footer text-white clearfix small z-1" href="#">
                <span class="float-left">查看详细信息</span>
                <span class="float-right">
                    <i class="fa fa-angle-right"></i>
                </span>
            </a>
        </div>
    </div>
    <div class="col-xl-3 col-sm-6 mb-3">
        <div class="card text-white bg-warning o-hidden h-100">
            <div class="card-body">
                <div class="card-body-icon">
                    <i class="fa fa-fw fa-list"></i>
                </div>
                <div class="mr-5">{{runningProcessesCount}}个运行的进程</div>
            </div>
            <a class="card-footer text-white clearfix small z-1" href="#">
                <span class="float-left">查看详细信息</span>
                <span class="float-right">
                    <i class="fa fa-angle-right"></i>
                </span>
            </a>
        </div>
    </div>
    <div class="col-xl-3 col-sm-6 mb-3">
        <div class="card text-white bg-success o-hidden h-100">
            <div class="card-body">
                <div class="card-body-icon">
                    <i class="fa fa-fw fa-circle"></i>
                </div>
                <div class="mr-5">0台CPU占用率过高</div>
            </div>
            <a class="card-footer text-white clearfix small z-1" href="#">
                <span class="float-left">查看详细信息</span>
                <span class="float-right">
                    <i class="fa fa-angle-right"></i>
                </span>
            </a>
        </div>
    </div>
    <div class="col-xl-3 col-sm-6 mb-3">
        <div class="card text-white bg-danger o-hidden h-100">
            <div class="card-body">
                <div class="card-body-icon">
                    <i class="fa fa-fw fa-bell-o"></i>
                </div>
                <div class="mr-5">0台内存占用率过高</div>
            </div>
            <a class="card-footer text-white clearfix small z-1" href="#">
                <span class="float-left">查看详细信息</span>
                <span class="float-right">
                    <i class="fa fa-angle-right"></i>
                </span>
            </a>
        </div>
    </div>
</div>

<!-- Area Chart Example-->
<div class="card mb-3">
    <div class="card-header d-flex">
        <div>
            <i class="fa fa-bar-chart"></i> 最常用的应用程序</div>
        <div class="ml-auto">
            <label for="stat_category_select">按</label>
            <select id="stat_category_select" [(ngModel)]="statisticAppRunningType" (change)="mostUsedAppParamChanged()">
                <option value="ByTime">运行时间</option>
                <option value="ByCount">运行次数</option>
            </select>
            <label for="stat_category_select">统计</label>
            <label for="time_span_select">选择统计时段</label>
            <select id="time_span_select" [(ngModel)]="timespanForMostusedApp" (change)="mostUsedAppParamChanged()">
                <option value="week">本周</option>
                <option value="preWeek" selected>上周</option>
                <option value="month">本月</option>
                <option value="year">今年</option>
            </select>

            <label for="amount_select">显示前</label>
            <select id="amount_select" [(ngModel)]="amountForMostusedApp" (change)="mostUsedAppParamChanged()">
                <option value="10" selected>10个</option>
                <option value="15">15个</option>
                <option value="20">20个</option>
                <option value="30">30个</option>
                <option value="50">50个</option>
            </select>
        </div>
    </div>
    <div class="card-body">
        <div echarts [options]="defaultOption" (chartInit)="onAppRunningTimeBarChartInit($event)" (chartClick)="onChartClick($event)"
            class="appRunningTimeBarChart" id="appRunningTimeBarChart">
        </div>
    </div>
    <div class="card-footer small text-muted">
        <i class="fa fa-refresh refresh-app-bar" id="refreshAppTimeBarChart" aria-hidden="true" (click)="refreshAppTimeBarChart()"></i>
        <label for="refreshAppTimeBarChart">手动更新与{{appRunningTimeBarUpdateTime}}</label>
    </div>
</div>

<div class="row">
    <div class="col-lg-8">
        <!-- Example Bar Chart Card-->
        <div class="card mb-3">
            <div class="card-header d-flex">
                <div>
                    <i class="fa fa-area-chart"></i>工作站运行统计</div>
                <div class="ml-auto">
                </div>
            </div>
            <div class="card-body">
                <StationRunningStatistic [showCtrl]="false"></StationRunningStatistic>
            </div>
            <div class="card-footer small text-muted d-flex">
                <div>手动更新</div>
                <div class="ml-auto">
                    <a routerLink="/stat" class="mr-3 d-inline-block">更多...</a>
                </div>
            </div>
        </div>
        <!-- Card Columns Example Social Feed-->
        <div class="mb-0 mt-4">
            <i class="fa fa-newspaper-o"></i> 工作站消息</div>
        <hr class="mt-2">
        <div class="card-columns">
            <!-- Example Social Card-->
            <div class="card mb-3" *ngFor="let message of startAndExitMessages">
                <div class="card-body">
                    <h6 class="card-title mb-1">
                        <a href="#">{{message.computerName}}</a>
                    </h6>
                    <ng-container *ngIf="message.isExit; else startProcessTemplate">
                        <p class="card-text small">关闭了进程
                            <a href="#">#{{message.processName}}</a>！
                        </p>
                    </ng-container>
                    <ng-template #startProcessTemplate>
                        <p class="card-text small">启动了进程
                            <a href="#">#{{message.processName}}</a>！
                        </p>
                    </ng-template>
                </div>
                <hr class="my-0">
                <div class="card-body py-2 small">
                    <a class="mr-3 d-inline-block" href="#">
                        <i class="fa fa-fw fa-thumbs-up"></i>Like</a>
                    <a class="mr-3 d-inline-block" href="#">
                        <i class="fa fa-fw fa-comment"></i>Comment</a>
                    <a class="d-inline-block" href="#">
                        <i class="fa fa-fw fa-share"></i>Share</a>
                </div>
                <div class="card-footer small text-muted">动作发生于{{message.actionTime}}</div>
            </div>
        </div>
        <!-- /Card Columns-->
    </div>
    <div class="col-lg-4">
        <!-- Example Pie Chart Card-->
        <div class="card mb-3">
            <div class="card-header">
                <i class="fa fa-pie-chart"></i>当前工作站状态</div>
            <div class="card-body">
                <div echarts [options]="defaultOption" (chartInit)="onChartInit($event)" (chartClick)="onChartClick($event)" class="runningStationPieChart"
                    id="runningStationPieChart">
                </div>
            </div>
            <div class="card-footer small text-muted">更新于 {{updateTime | date:'HH:mm:ss'}}</div>
        </div>
        <!-- Example Notifications Card-->
        <div class="card mb-3">
            <div class="card-header">
                <i class="fa fa-bell-o"></i>告警消息</div>
            <div class="list-group list-group-flush small">
                <a class="list-group-item list-group-item-action" href="#" *ngFor="let alert of alerts">
                    <div class="media">
                        <ng-container *ngIf="alert.cpu>85 || alert.memoryPercent>0.85; else warningBlock">
                            <img class="d-flex mr-3 rounded-circle" src="../../images/error.png" alt="Error">
                        </ng-container>
                        <ng-template #warningBlock>
                            <img class="d-flex mr-3 rounded-circle" src="../../images/warning.png" alt="Warning">
                        </ng-template>

                        <div class="media-body">
                            <ng-container *ngIf="alert.cpu>70; else memHighBlock">
                                <strong>{{alert.computerName}}</strong> CPU 占用率过高。CPU占用率：
                                <strong>{{alert.cpu|floor}}%</strong>.
                                <div class="text-muted smaller">时间:{{alert.recordTime|date:'yyyy-MM-dd HH:mm:ss'}}</div>
                            </ng-container>
                            <ng-template #memHighBlock>
                                <strong>{{alert.computerName}}</strong> 内存占用率过高。内存占用率：
                                <strong>{{alert.memoryPercent*100|floor}}%</strong>.
                                <div class="text-muted smaller">时间:{{alert.recordTime|date:'yyyy-MM-dd HH:mm:ss'}}</div>
                            </ng-template>
                        </div>
                    </div>
                </a>
                <a class="list-group-item list-group-item-action" href="#">View all activity...</a>
            </div>
            <div class="card-footer small text-muted">Updated yesterday at 11:59 PM</div>
        </div>
    </div>
</div>

<!-- Example DataTables Card-->
<div class="card mb-3">
    <div class="card-header d-flex">
        <div>
            <i class="fa fa-table"></i>工作站列表</div>
        <div class="ml-auto">
            <input type="checkbox" value="" id="powerOnOnly-checkbox" [(ngModel)]="powerOnOnly" (change)="powerOnOnly_changed()">
            <label for="powerOnOnly-checkbox">只显示运行的工作站信息</label>
        </div>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
                <thead>
                    <tr>
                        <th>计算机名</th>
                        <th>用户</th>
                        <th>专业组</th>
                        <th>开机时间</th>
                        <th>操作系统</th>
                        <th>内存(MB)</th>
                    </tr>
                </thead>
                <tfoot>
                    <tr>
                        <th>计算机名</th>
                        <th>用户</th>
                        <th>专业组</th>
                        <th>开机时间</th>
                        <th>操作系统</th>
                        <th>内存(MB)</th>
                    </tr>
                </tfoot>
                <tbody>
                    <tr *ngFor="let item of stationsInfo">
                        <td>
                            <i class="fa fa-circle" [ngClass]="{'green': item.isRunning}"></i>{{item.computerName}}</td>
                        <td>{{item.userName}}</td>
                        <td>{{item.groupName}}</td>
                        <td>{{item.powerOn | date:"yyyy-MM-dd HH:mm:ss"}}</td>
                        <td>{{item.osName}}</td>
                        <td>{{item.totalMemory}}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div class="card-footer small text-muted">更新于 {{stationInfoUpdateTime | date:"yyyy-MM-dd HH:mm:ss"}}</div>
</div>